#:import MapSource kivy_garden.mapview.MapSource
#:import asynckivy asynckivy

MainScreen:
    id: mainScreen
    link_screen_manager: screen_manager
    link_reservation_screen: reservationScreen
    MDNavigationLayout:
        MDScreenManager:
            id: screen_manager
            MDScreen:
                name: "screen1"
                MDButton:
                    style: "elevated"
                    pos_hint: {"center_x": .5, "center_y": .5}

                    MDButtonIcon:
                        icon: "plus"

                    MDButtonText:
                        text: "Elevated"
                ParksMapView:
                    bottom_sheet: bottom_sheet
                    map_source: MapSource(url=app.map_sources[app.current_map])
                    lat: 53.3
                    lon: 58.9
                    zoom: 10
                    on_zoom:
                        self.zoom = 10 if self.zoom < 10 else self.zoom
                    on_lat:
                        self.StartGettingParksInFov()
                    on_lon:
                        self.StartGettingParksInFov()
                BottomSheet:
                    id: bottom_sheet
                    link_button: buttonReservation
                    link_list: listBottomSheet
                    link_screen: mainScreen
                    sheet_type: "modal"
                    size_hint_y: 0.8
                    orientation: "vertical"
                    md_bg_color: app.theme_cls.surfaceColor

                    MDBottomSheetDragHandle:
                        drag_handle_color: "grey"
                        MDBottomSheetDragHandleTitle:
                            text: "text"
                            pos_hint: {"center_y": .5}

                        MDBottomSheetDragHandleButton:
                            icon: "close"
                            ripple_effect: False
                            on_release: bottom_sheet.dismiss(bottom_sheet)
                    BoxLayout:
                        id: content_container
                        orientation: "vertical"
                        padding: 0, 0, 0, "20dp"
                        spacing: 50

                        MDList:
                            id: listBottomSheet
                            padding: 0, 0, 250, 0

                        MDBoxLayout:
                            padding: 250, "50sp", 0, 100
                            spacing: 50
                            MDButton:
                                id: buttonReservation
                                style: "elevated"
                                #size_hint_x: None
                                pos_hint: {"center_x": .5, "center_y": .5}
                                theme_bg_color: "Custom"
                                md_bg_color: "#000000"
                                on_release: bottom_sheet.Reservation()#root.link_screen_manager.current = "screen2"
                                #icon_color: "white"
                                #text: "хуй" почётный комментарий, не трогать!!!
    #                            MDButtonIcon:
    #                                icon: "plus"

                                MDButtonText:
                                    text: "Бронировать"
                                    theme_text_color: "Custom"
                                    text_color: "white"

                            MDButton:
                                id: buttonPay
                                style: "elevated"
                                pos_hint: {"center_x": .5, "center_y": .5}
                                theme_bg_color: "Custom"
                                md_bg_color: "#000000"
                                #icon_color: "white"
                                #text: "хуй" почётный комментарий, не трогать!!!
    #                            MDButtonIcon:
    #                                icon: "plus"

                                MDButtonText:
                                    text: "Оплатить"
                                    theme_text_color: "Custom"
                                    text_color: "white"

            ReservationScreen:
                id: reservationScreen
#                radius: [25, 0, 0, 0]
#                md_bg_color: self.theme_cls.primaryColor
                name: "screen2"
                titleParking: labelTitle
                addressParking: labelAddress
                dateParking: labelData
                timeStart: labelTime
                numbersCar: labelNumbersCar
                MDBoxLayout:
                    orientation: "vertical"
                    spacing: 50
                    #pos_hint: {"center_x": 0.1,  "center_y": 0.9}
                    MDLabel:
                        id: labelTitle
                    MDTextFieldHintText:
                        text: "Hint text"
                    MDLabel
                        id: labelAddress
                    MDLabel:
                        id: labelData
                        text: "пока не придумали как дату выводить"
                    MDLabel
                        id: labelTime
                        text: "пока не придумали как время выводить"
                    MDLabel
                        id: labelNumbersCar








